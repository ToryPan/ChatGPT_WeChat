**ç®€ä»‹ï¼š**

æœªè®¤è¯å¾®ä¿¡å…¬ä¼—å·æŽ¥å…¥chatgptï¼Œæ–°å¢žè¯­éŸ³èŠå¤©(è‹±è¯­å¯¹è¯)ï¼ŒåŸºäºŽFlaskï¼Œå®žçŽ°ä¸ªäººå¾®ä¿¡å…¬ä¼—å·ã€æ— è®¤è¯ã€‘æŽ¥å…¥ChatGPT

**--æ›´æ–°è¯´æ˜Žï¼š**
  
  V1.0ï¼š
  
  -æ–°å¢žè¯­éŸ³èŠå¤©åŠŸèƒ½ï¼ŒæŽ¥å…¥å¾®è½¯äº‘æ–‡æœ¬è½¬è¯­éŸ³æœåŠ¡(å…è´¹æŽ¥å…¥)ï¼Œå®žçŽ°è¯­éŸ³å¯¹è¯(ä¸­è‹±æ–‡)ï¼›
  
  -å†…ç½®è‹±è¯­å­¦ä¹ æ¨¡æ¿, å›žå¤æ¨¡æ¿æ¶ˆæ¯å³å¯è¿›è¡Œè‹±è¯­ä¸»é¢˜å¯¹è¯ï¼›
  
  -æ–°å¢žå¾®ä¿¡åŽå°ç™½åå•IPæ£€æµ‹ï¼Œé˜²æ­¢dossç­‰ï¼›
  
  -æ–°å¢žç”¨æˆ·æ¶ˆæ¯é¢‘çŽ‡é™åˆ¶ï¼Œé˜²æ­¢æ¶æ„åˆ·æ¶ˆæ¯ï¼›
  
  -è‡ªåŠ¨æ¸…ç†ä¸´æ—¶è¯­éŸ³æ–‡ä»¶ï¼›
  
  -è‡ªåŠ¨æ¸…ç†å¾®ä¿¡åŽå°ä¸Šä¼ ä¸´æ—¶è¯­éŸ³ç´ æï¼›
  
  -ä¼˜åŒ–æ€§èƒ½ã€ä¿®å¤BUGã€‚

**èƒŒæ™¯ï¼š**

æœ€è¿‘çœ‹åˆ°ChatGPTæä¾›äº†APIæŽ¥å£ï¼Œæ‰‹ä¸Šåˆšå¥½æœ‰å°æœåŠ¡å™¨å’Œä¸€ä¸ªå…¬ä¼—å·ï¼Œæ‰€ä»¥æƒ³ç€å†™ä¸€ä¸ªèŠå¤©æœºå™¨äººðŸ¤–çŽ©ä¸€çŽ©ã€‚ä¸è¿‡åªæœ‰ä¸€ä¸ªæ²¡æœ‰è®¤è¯çš„ä¸ªäººå…¬ä¼—å·(èµ„æºæœ‰é™ðŸ˜­)ï¼Œè¿™ä¸ªå…¬ä¼—å·çš„é™åˆ¶å°±æ˜¯ï¼š

1.åªèƒ½è¢«åŠ¨å›žå¤ç”¨æˆ·æ¶ˆæ¯ï¼Œç”¨æˆ·å‘é€ä¸€æ¡æ¶ˆæ¯åˆ°å…¬ä¼—å·ï¼ŒæœåŠ¡å™¨åªèƒ½é’ˆå¯¹è¿™ä¸ªè¯·æ±‚å›žå¤ä¸€æ¡æ¶ˆæ¯ï¼Œä¸èƒ½å†é¢å¤–å›žå¤æ¶ˆæ¯(å®¢æœæ¶ˆæ¯)ï¼›

2.æ¯æ¬¡å¿…é¡»åœ¨15sä»¥å†…å›žå¤æ¶ˆæ¯ï¼Œå…¬ä¼—å·å¹³å°åœ¨å‘é€è¯·æ±‚åˆ°æœåŠ¡å™¨åŽï¼Œå¦‚æžœ5så†…æ²¡æ”¶åˆ°å›žå¤ï¼Œä¼šå†æ¬¡å‘é€è¯·æ±‚ç­‰å€™5ç§’ï¼Œå¦‚æžœè¿˜æ˜¯æ²¡æœ‰æ”¶åˆ°è¯·æ±‚ï¼Œæœ€åŽè¿˜ä¼šå‘é€ä¸€æ¬¡è¯·æ±‚ï¼Œæ‰€ä»¥æœåŠ¡å™¨å¿…é¡»åœ¨15sä»¥å†…å®Œæ•´æ¶ˆæ¯çš„å¤„ç†ã€‚

å…·ä½“å¤„ç†æ–¹å¼æŸ¥çœ‹ä»£ç ã€‚æ–°æ‰‹é¡¹ç›®ï¼Œæœ‰ä¸è¶³ä¹‹å¤„è¿˜è¯·åŒ…å«å¹¶æ¬¢è¿ŽæŒ‡æ­£ï¼Œè°¢è°¢~

**éœ€æ±‚ï¼š**

ä¸€å°æœåŠ¡å™¨ï¼ˆéœ€è¦èƒ½è®¿é—®openaiæŽ¥å£çš„ï¼Œå¯èƒ½éœ€è¦æµ·å¤–çš„~ï¼‰

å¦‚æžœéœ€è¦å¼€å¯æ–‡æœ¬è½¬è¯­éŸ³æœåŠ¡ï¼Œéœ€è¦æ³¨å†ŒAzureçš„æ–‡æœ¬è½¬è¯­éŸ³ï¼Œè¯¥æœåŠ¡æ³¨å†Œå’Œä½¿ç”¨å…è´¹ï¼Œå…·ä½“å‚è€ƒç½‘å€ï¼š[AZURE](https://azure.microsoft.com/en-us/products/cognitive-services/text-to-speech/)

å¾®ä¿¡å…¬ä¼—å·ï¼šä¸ªäººç±»åž‹å³å¯

**æ¼”ç¤ºï¼š**

å…¬ä¼—å·ï¼šToryçš„å®žéªŒå®¤ï¼Œå…³æ³¨å‘é€æ¶ˆæ¯å³å¯ä½“éªŒã€‚

å…¬ä¼—å·æŽ¨æ–‡ä»‹ç»:

  1.å…¥é—¨ä½¿ç”¨ä»‹ç»ï¼š[ChatGPTå·²æŽ¥å…¥](https://mp.weixin.qq.com/s/KOIkDTAEnIW_0uwM3iS-0g)

  2.è¯­éŸ³æœåŠ¡ä½¿ç”¨ä»‹ç»ï¼š[è¯­éŸ³æœåŠ¡å·²æŽ¥å…¥](https://mp.weixin.qq.com/s/cEaqzOFzXGNFm7yd4zWwBw)


![image-20230305121520474](https://github.com/ToryPan/ChatGPT_WeChat/blob/main/pic/image-20230305121520474.png)

**ä½¿ç”¨æ–¹æ³•ï¼š**

è®¾ç½®configé‡Œé¢çš„config.ymlå‚æ•°ï¼š

```yml
# å¾®ä¿¡ç›¸å…³è®¾ç½®
wechat:
  appid: "****"
  secret: "****"
  token: "****"

# openaiç›¸å…³è®¾ç½®
openai:
  api_keys:
   - "Bearer sk-****"
   - "Bearer sk-****"
   - "Bearer sk-****"
  # å•æ¡æ¶ˆæ¯çš„é•¿åº¦
  max_tokens: 150
  # æ¨¡åž‹
  model: "gpt-3.5-turbo-0301"
  # temperatureï¼Œè¶Šå¤§éšæœºæ€§è¶Šå¼º
  temperature: 0.8
  # æœ‰æ—¶å€™æ–‡æœ¬é•¿åº¦è¶…è¿‡150ï¼Œç”¨è¯¥å‚æ•°é™åˆ¶é•¿åº¦é¿å…è¶…è¿‡å¾®ä¿¡èƒ½å‘é€çš„æœ€é•¿æ¶ˆæ¯
  rsize: 500
  # å¯¹è¯çš„ä¿å­˜åŽ†å²
  save_history: 21
  
# azureæ–‡æœ¬è½¬è¯­éŸ³è®¾ç½®
azure:
  # æ˜¯å¦å¼€å¯æ–‡æœ¬è½¬è¯­éŸ³æœåŠ¡
  trans_to_voice: false
  # æ–°å®šä¹‰æ–‡æœ¬é•¿åº¦ï¼Œå¼€å¯åŽå¢žåŠ å¤„ç†æ—¶é—´ï¼Œé¿å…æ–‡æœ¬å¤ªé•¿ï¼Œå¤„ç†æ—¶é—´è¿‡ä¹…ï¼Œè¶…è¿‡15s
  max_token: 80
  # å¯†é’¥
  subscription: "****"
  region: "koreacentral"
  # ä¸­æ–‡è¯­éŸ³æ¨¡åž‹
  zh_model: "zh-CN-XiaoyanNeural"
  # è‹±æ–‡è¯­éŸ³æ¨¡åž‹
  en_model: "en-US-AriaNeural"
```

å¯åŠ¨flask

```sh
export FLASK_APP=myflask

flask run --host=0.0.0.0 --port=80
# æˆ–è€…
nohup flask run --host=0.0.0.0 --port=80 >> /home/jupyter/flask/log/wechat.log 2>&1 &
```


